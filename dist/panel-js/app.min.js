const queryParams=new URLSearchParams(window.location.search),queryPassword=queryParams.get("password"),countPage=(queryParams.has("password")||(window.location.href="/404"),document.getElementById("count-page")),prevBtn=document.getElementById("prevBtn"),nextBtn=document.getElementById("nextBtn"),ordersContainer=document.getElementById("orders-container"),ordersCount=document.getElementById("orders-count"),allPrice=document.getElementById("all-price"),lastOrderTime=document.getElementById("last-order-time"),logOut=document.getElementById("log-out"),orderElements=document.getElementsByClassName("order");let partedArr,pagintationCounter=1;function updateResults(e){var t=e[e.length-1],r=e.reduce((e,t)=>e+parseFloat(t.price),0),n=e.slice().sort((e,t)=>e.client.localeCompare(t.client)),o=e.slice().sort((e,t)=>parseFloat(e.price)-parseFloat(t.price)),i=e.slice().reverse();function a(e,t){document.getElementById(t).addEventListener("click",function(){getOrders((partedArr=getPartedArr(e))[pagintationCounter-1])})}getOrders((partedArr=getPartedArr(e))[pagintationCounter-1]),a(n,"sort-clientName"),a(o,"sort-price"),a(i,"sort-date"),refreshResults(r,t,e)}function refreshResults(e,t,r){allPrice.innerText="$"+e,lastOrderTime.innerText=t.orderTime,ordersCount.innerText=r.length}function attachDeleteListeners(e){var t;for(t of document.getElementsByClassName("delete-order"))t.addEventListener("click",function(){var e=this.closest(".order").id;document.getElementById(e).remove(),axios.post("/delete-order",e),axios.get("/get-orders").then(e=>{updateResults(e.data)}).catch(e=>{console.error("Error getting info: "+e)})})}function attachToggleListeners(){for(let t=0;t<orderElements.length;t++){let e=0;orderElements[t].addEventListener("click",function(){e=0===e?-540:0,this.style.marginLeft=e+"px"})}}function nextClick(e){pagintationCounter<=e.length-1&&(pagintationCounter++,getOrders(e[(countPage.innerText=pagintationCounter)-1]))}function prevClick(e){1<pagintationCounter&&(pagintationCounter--,getOrders(e[(countPage.innerText=pagintationCounter)-1]))}function getPartedArr(t){var r=[];for(let e=0;e<t.length;e+=2)r.push(t.slice(e,e+2));return r}function getOrders(e){ordersContainer.innerHTML="";for(var t of e){var r=document.createElement("div");r.setAttribute("class","order"),r.setAttribute("id",t.orderID),r.innerHTML=`
            <div class="left-part">
                <img src="${t.img}" alt="">
            </div>
            <div class="right-part">
                <h2>${t.good}</h2>
                <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Natus corporis perferendis reprehenderit. Quia dolorum possimus minus voluptatibus quibusdam! Velit, harum.</p>
                <p>Count: <span>${t.count} pcs</span></p>
                <p>Client: <span>${t.client}</span></p>
                <p>Ordered: <span>${t.orderTime}</span></p>
                <h4 style="align-self: center;">Costs: <span class="price">$${t.price}</span></h4>
            </div>
            <div class="delete-order">delete</div>
        `,ordersContainer.appendChild(r)}attachDeleteListeners(e),attachToggleListeners()}countPage.innerText=pagintationCounter,nextBtn.addEventListener("click",function(){nextClick(partedArr)}),prevBtn.addEventListener("click",function(){prevClick(partedArr)}),logOut.addEventListener("click",function(){window.location.href="/"}),document.querySelector(".open-sort").addEventListener("click",function(){var e=document.querySelector(".sort-container");e.style.left="0px"===e.style.left?"-320px":"0px"}),axios.get("/get-orders").then(e=>{updateResults(e.data)}).catch(e=>{console.error("Error getting info: "+e)});